{% extends "base.html" %}
{% load static %}

{% block content %}

<div class="container" id="top-panel">
    <h1>Bookmarks Storage</h1>

    <div  class="btn-group btn-group-sm">

      <a class="btn btn-info" href="/search/list" 
        title="Saved search">Search</a>

      <a class="btn btn-info" 
           href="items" 
           title="List all items ordered by the latest">List all</a>
      
      <a class="btn btn-info" 
          href="items?view=latest" 
          title="Order by oldest">Oldest</a>

      <a class="btn btn-info" href="items?view=starred" 
          title="List only starred items">Starred</a>

      <a class="btn btn-info" href="{% url 'bookmarks:bookmark_new' %}">Add</a>                              

      <a class="btn btn-info" href="/" 
          title="Go to home page or index">Index</a>

      <br/>

 <!--      {% if request.session.video_toggle %}
        <a class="btn btn-info" title="Disable Youtube Video Embedding" href="/options/video_toggle?url={{ request.get_full_path | urlencode}}">Disable Video</a> </li>    
      {% else %}
        <a class="btn btn-info" title="Enable Youtube Video Embedding" href="/options/video_toggle?url={{ request.get_full_path | urlencode }}">Enable Video</a> </li>    
      {% endif %} -->

</div>

<div class="">
  <form method='GET' class="form-group">
      <input type='text' name='search' value='{{ request.GET.search }}'>
      <input class="btn btn-info" type='submit' value="Search">
  </form> 
</div>


</div>

<div id="bookmark-list" class="container">     
    
    {% if object_list.has_other_pages %}
    
       <ul class="pagination">
            {% if object_list.has_previous %}
              <li><a class="btn btn-primary" href="?page={{ object_list.previous_page_number }}&{{url_state}}">&laquo;</a></li>
            {% else %}
              <li  class="btn btn-primary" class="disabled"><span>&laquo;</span></li>
            {% endif %}            
            
            {% for i in page_range %}
              {% if object_list.number == i %}
                <li class="active btn btn-info"><span>{{ i }} <span class="sr-only">(current)</span></span></li>
              {% else %}
                <li><a class = "btn btn-primary" href="?page={{ i }}&{{url_state}} ">{{ i }}</a></li>
              {% endif %}
            {% endfor %}
            {% if object_list.has_next %}
              <li><a class="btn btn-primary" href="?page={{ object_list.next_page_number }}&{{url_state}}">&raquo;</a></li>
            {% else %}
              <li class="btn btn-primary disabled"><span>&raquo;</span></li>
            {% endif %}
          </ul>
     
    {% endif %}    

    Found {{count}} results.

    {% for bookmark in object_list %}
        <div class = "well item ">   
            <h5> ID = {{ bookmark.id }} / <a target='_blank' title="{{bookmark.brief}}" href="{{ bookmark.url }}"> {{ bookmark.modified_title | default:bookmark.url }} </a></h5>
            
            <br/>

                    <a class="btn btn-primary" title="Edit current item" href="{% url 'bookmarks:bookmark_edit' bookmark.id %}?url={{  request.get_full_path | urlencode }}">Edit</a>

                    {% if bookmark.deleted != True  %}
                        <a class="btn btn-primary" title="Delete current item" href="{% url 'bookmarks:bookmark_delete' bookmark.id %}">Delete</a>                           
                    {% endif %}

                    <a class="btn btn-primary" title="Fetch bookmark metdata automatically" 
                        href="/items/extract_metadata?id={{ bookmark.id }}&url={{  request.get_full_path | urlencode }}">Get metadata</a>

                    {%if bookmark.isDocumentFile %}
                        <a target="_blank" href="{{ bookmark.modifiedURL }}" title="View document in Google Driver viewer" > <img src="{% static "gdriver.png" %}"> </a>
                    {% endif %}

                    <br/>                    
            <ul>
              <li> keywords: {{ bookmark.keywords }} </li>
              <li> Domain = <a href="items?domain={{ bookmark.hostname }}" title="Fliter by domain {{ bookmark.hostname }}" > {{ bookmark.hostname }} </a> </li>              
              <li> Created  = {{ bookmark.created }} ; Modified = {{ bookmark.updated }} </li>
              <li> starred = {{ bookmark.starred }} </li>            
            </ul>          

            <p class = ""> {{ bookmark.brief|default:"" }} </p>

            {% if bookmark.is_youtube_video and request.session.video_toggle  %}
              <iframe src="https://www.youtube.com/embed/{{ bookmark.youtube_id }}" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
            {% endif %}
        </div>                            
    {% endfor %}
    

</div>

{% endblock %}
